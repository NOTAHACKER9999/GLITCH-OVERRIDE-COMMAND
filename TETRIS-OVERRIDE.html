<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tetris OVERRIDE</title>
<style>
  :root{
    --bg:#000000;
    --panel:#1a0000;
    --accent:#ff1e1e;
    --muted:#ff8080;
  }
  html,body{
    height:100%;margin:0;
    font-family:sans-serif;
    color:#ffcccc;
    background:linear-gradient(180deg,var(--bg),#1a0000);
    display:flex;flex-direction:column;align-items:center;justify-content:center;
  }
  .wrap{
    display:flex;
    flex-direction:row;
    gap:12px;
    align-items:flex-start;
    flex-wrap:wrap;
    justify-content:center;
  }
  .game{
    background:linear-gradient(180deg,#000,#1a0000);
    border-radius:12px;
    padding:8px;
    box-shadow:0 4px 20px rgba(255,0,0,.5);
  }
  canvas{
    background:#0a0000;
    display:block;
    border-radius:6px;
    touch-action:none;
  }
  .side{
    min-width:180px;
    background:var(--panel);
    border-radius:10px;
    padding:10px;
    color:#ffb3b3;
    font-size:14px;
    box-shadow:inset 0 0 10px rgba(255,0,0,0.4);
  }
  h1{
    font-size:20px;
    margin:0 0 6px 0;
    color:var(--accent);
    text-shadow:0 0 8px var(--accent);
  }
  .stat{
    display:flex;
    justify-content:space-between;
    margin-bottom:6px;
  }
  button{
    width:100%;
    padding:6px;
    margin-top:6px;
    border:0;
    border-radius:8px;
    background:linear-gradient(90deg,var(--accent),#ff4d4d);
    color:#fff;
    cursor:pointer;
    font-weight:600;
    box-shadow:0 0 6px rgba(255,0,0,0.6);
  }
  .controls{
    font-size:12px;
    color:var(--muted);
    margin-top:8px;
  }
  .touch-controls{
    display:grid;
    grid-template-columns:repeat(3,60px);
    gap:8px;
    justify-content:center;
    margin-top:12px;
  }
  .touch-controls button{
    padding:12px;
    font-size:20px;
    border-radius:50%;
    background:#330000;
    color:white;
    box-shadow:0 0 8px rgba(255,0,0,0.5);
  }
  @media (max-width:600px){
    .wrap{flex-direction:column;align-items:center;}
    .side{width:100%;max-width:260px;}
  }
</style>
</head>
<body>
<div class="wrap">
  <div class="game">
    <canvas id="board" width="240" height="480"></canvas>
  </div>
  <div class="side">
    <h1>TETRIS OVERRIDE</h1>
    <div class="stat"><div>Score</div><div id="score">0</div></div>
    <div class="stat"><div>Level</div><div id="level">1</div></div>
    <div class="stat"><div>Lines</div><div id="lines">0</div></div>
    <button id="startBtn">Start / Restart</button>
    <button id="pauseBtn">Pause</button>
    <div class="controls">Keyboard: arrows = move/rotate, space = drop, P = pause</div>
  </div>
</div>

<div class="touch-controls">
  <button id="leftBtn">←</button>
  <button id="rotateBtn">⟳</button>
  <button id="rightBtn">→</button>
  <button id="downBtn">↓</button>
  <button id="dropBtn" style="grid-column: span 3;">⬇️ DROP</button>
</div>

<script>
// Game setup
const COLS=10, ROWS=20, BLOCK=24;
const COLORS={I:'#ff4d4d',J:'#ff3333',L:'#ff1a1a',O:'#e60000',S:'#cc0000',T:'#b30000',Z:'#990000'};
const boardCanvas=document.getElementById('board'), ctx=boardCanvas.getContext('2d');
let grid, current, nextPiece, dropCounter, dropInterval, lastTime, isPaused, isOver, score, level, lines, isRunning;
const scoreEl=document.getElementById('score'), levelEl=document.getElementById('level'), linesEl=document.getElementById('lines');
const startBtn=document.getElementById('startBtn'), pauseBtn=document.getElementById('pauseBtn');
const TETROMINOS={I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],J:[[1,0,0],[1,1,1],[0,0,0]],L:[[0,0,1],[1,1,1],[0,0,0]],O:[[1,1],[1,1]],S:[[0,1,1],[1,1,0],[0,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]]};
const PIECE_NAMES=Object.keys(TETROMINOS);
function createMatrix(w,h){return Array.from({length:h},()=>Array(w).fill(0));}
function randomPiece(){let type=PIECE_NAMES[Math.random()*PIECE_NAMES.length|0];return {type,shape:TETROMINOS[type].map(r=>r.slice()),x:3,y:0};}
function drawCell(x,y,color){ctx.fillStyle=color;ctx.fillRect(x*BLOCK+1,y*BLOCK+1,BLOCK-2,BLOCK-2);}
function draw(){ctx.clearRect(0,0,boardCanvas.width,boardCanvas.height);for(let y=0;y<ROWS;y++){for(let x=0;x<COLS;x++){let v=grid[y][x];if(v)drawCell(x,y,COLORS[v]);}}drawPiece(current);}
function drawPiece(p){p.shape.forEach((r,dy)=>r.forEach((v,dx)=>{if(v)drawCell(p.x+dx,p.y+dy,COLORS[p.type]);}));}
function collide(shape,pos){for(let y=0;y<shape.length;y++){for(let x=0;x<shape[y].length;x++){if(shape[y][x]&&(grid[pos.y+y]&&grid[pos.y+y][pos.x+x])!==0){return true;}}}return false;}
function merge(){current.shape.forEach((r,dy)=>r.forEach((v,dx)=>{if(v)grid[current.y+dy][current.x+dx]=current.type;}));}
function rotate(m){return m[0].map((_,i)=>m.map(r=>r[i]).reverse());}
function playerDrop(){if(!collide(current.shape,{x:current.x,y:current.y+1}))current.y++;else{merge();playerReset();sweep();}}
function sweep(){let rowCount=0;outer:for(let y=ROWS-1;y>=0;y--){for(let x=0;x<COLS;x++){if(!grid[y][x])continue outer;}grid.splice(y,1);grid.unshift(Array(COLS).fill(0));rowCount++;}if(rowCount){score+=rowCount*10;lines+=rowCount;level=1+Math.floor(lines/10);dropInterval=Math.max(100,1000-(level-1)*70);updateUI();}}
function playerReset(){current=nextPiece||randomPiece();nextPiece=randomPiece();if(collide(current.shape,current)){isOver=true;isRunning=false;alert("Game Over — Score: "+score);}}
function updateUI(){scoreEl.textContent=score;levelEl.textContent=level;linesEl.textContent=lines;}
function update(t=0){if(!isRunning||isPaused)return requestAnimationFrame(update);const delta=t-lastTime;lastTime=t;dropCounter+=delta;if(dropCounter>dropInterval){playerDrop();dropCounter=0;}draw();requestAnimationFrame(update);}
function startGame(){grid=createMatrix(COLS,ROWS);score=0;level=1;lines=0;dropCounter=0;dropInterval=1000;isPaused=false;isOver=false;isRunning=true;nextPiece=randomPiece();playerReset();lastTime=performance.now();updateUI();update();}
function togglePause(){if(isOver)return;isPaused=!isPaused;}
function move(dir){current.x+=dir;if(collide(current.shape,current))current.x-=dir;}
function hardDrop(){while(!collide(current.shape,{x:current.x,y:current.y+1}))current.y++;merge();playerReset();sweep();}
function rotatePiece(){const s=rotate(current.shape);const old=current.shape;current.shape=s;if(collide(current.shape,current))current.shape=old;}
document.addEventListener('keydown',e=>{if(e.key==='ArrowLeft')move(-1);else if(e.key==='ArrowRight')move(1);else if(e.key==='ArrowDown')playerDrop();else if(e.key==='ArrowUp')rotatePiece();else if(e.key===' ')hardDrop();else if(e.key==='p'||e.key==='P')togglePause();else if(e.key==='r'||e.key==='R')startGame();});
startBtn.onclick=startGame;pauseBtn.onclick=togglePause;
// Touch controls
document.getElementById('leftBtn').onclick=()=>move(-1);
document.getElementById('rightBtn').onclick=()=>move(1);
document.getElementById('downBtn').onclick=()=>playerDrop();
document.getElementById('rotateBtn').onclick=()=>rotatePiece();
document.getElementById('dropBtn').onclick=()=>hardDrop();
// Responsive scaling
function resizeCanvas(){let scale=Math.min(window.innerWidth/(COLS*BLOCK+20),window.innerHeight/(ROWS*BLOCK+200));boardCanvas.style.width=COLS*BLOCK*scale+'px';boardCanvas.style.height=ROWS*BLOCK*scale+'px';}
window.addEventListener('resize',resizeCanvas);resizeCanvas();
</script>
</body>
</html>