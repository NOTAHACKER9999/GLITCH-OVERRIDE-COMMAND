<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Flappy Bird — OVERRIDE</title>
<style>
  body { margin:0; background:black; color:red; font-family:sans-serif; text-align:center; }
  canvas { display:block; margin:auto; background:black; }
  #startBtn { background:red; color:black; font-size:20px; padding:10px 20px; border:none; cursor:pointer; border-radius:10px; position:absolute; left:50%; transform:translateX(-50%); top:60%; }
  #adminPanel {
    display:none; position:fixed; top:10%; left:50%; transform:translateX(-50%);
    background:black; border:2px solid red; padding:20px; color:red; z-index:999;
  }
  .closeBtn { background:red; color:black; border:none; padding:5px 10px; cursor:pointer; }
</style>
</head>
<body>
<h1>Flappy Bird — <span id="overrideTitle">OVERRIDE</span></h1>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<button id="startBtn">START GAME</button>

<div id="adminPanel">
  <h2>Admin Panel</h2>
  <label>Bird Color: <input type="color" id="birdColorPicker" value="#ff0000"></label><br><br>
  <label>Pipe Color: <input type="color" id="pipeColorPicker" value="#ff0000"></label><br><br>
  <label>Background Color: <input type="color" id="bgColorPicker" value="#000000"></label><br><br>
  <label>Custom Bird Image: <input type="file" id="birdImageInput" accept="image/*"></label><br><br>
  <label>Custom Background Image: <input type="file" id="bgImageInput" accept="image/*"></label><br><br>
  <button onclick="toggleInvincible()">Toggle Invincibility</button><br><br>
  <label>Set Score: <input type="number" id="scoreInput" value="0"></label>
  <button onclick="setScore()">Apply</button><br><br>
  <button class="closeBtn" onclick="closeAdmin()">Close</button>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let gravity = 0.4, jump = -6;
let birdY = canvas.height/2, birdX = 80, velocity = 0;
let pipes = [], frame = 0, score = 0, best = 0;
let playing = false, invincible = false;
let bgColor = "#000000", birdColor = "#ff0000", pipeColor = "#ff0000";
let customBirdImg = null, customBgImg = null;
let overrideClicks = 0, overrideTimeout;
let previewFloat = 0;

document.getElementById("startBtn").addEventListener("click", startGame);

function startGame(){
  playing = true;
  birdY = canvas.height/2; velocity = 0; score = 0;
  pipes = [{x:canvas.width, y:Math.random()*200+100}];
  document.getElementById("startBtn").style.display = "none";
}

function drawBird(x, y, size) {
  if (customBirdImg) {
    ctx.drawImage(customBirdImg, x - size/2, y - size/2, size, size);
  } else {
    ctx.fillStyle = birdColor;
    ctx.beginPath();
    ctx.arc(x, y, size/2, 0, Math.PI * 2);
    ctx.fill();
    ctx.strokeStyle = "black";
    ctx.lineWidth = 2;
    ctx.stroke();
    ctx.fillStyle = "black";
    ctx.beginPath();
    ctx.arc(x + size/5, y - size/5, size/8, 0, Math.PI * 2); // eye
    ctx.fill();
  }
}

function drawBackground(){
  if(customBgImg){
    ctx.drawImage(customBgImg, 0, 0, canvas.width, canvas.height);
  } else {
    ctx.fillStyle = bgColor;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  }
}

function drawPipes(){
  ctx.fillStyle = pipeColor;
  pipes.forEach(p=>{
    ctx.fillRect(p.x, 0, 50, p.y-75);
    ctx.fillRect(p.x, p.y+75, 50, canvas.height - p.y);
  });
}

function gameLoop(){
  drawBackground();

  if(playing){
    frame++;
    if(frame % 100 === 0) pipes.push({x:canvas.width, y:Math.random()*200+100});
    pipes.forEach(p=>p.x -= 2);
    pipes = pipes.filter(p=>p.x > -50);

    velocity += gravity;
    birdY += velocity;

    drawPipes();
    drawBird(birdX, birdY, 30);

    pipes.forEach(p=>{
      if(p.x === birdX) score++;
      if(!invincible && birdX+15 > p.x && birdX-15 < p.x+50 && (birdY-15 < p.y-75 || birdY+15 > p.y+75)){
        gameOver();
      }
    });

    if(birdY > canvas.height || birdY < 0) gameOver();

    ctx.fillStyle = "red";
    ctx.fillText("Score: "+score, 10, 20);
  } else {
    // Preview mode
    previewFloat += 0.05;
    drawPipes();
    drawBird(birdX, birdY + Math.sin(previewFloat)*5, 30);
  }

  requestAnimationFrame(gameLoop);
}

function gameOver(){
  playing = false;
  best = Math.max(best, score);
  document.getElementById("startBtn").style.display = "block";
}

document.addEventListener("keydown", e=>{
  if(e.code === "Space" || e.code === "ArrowUp") velocity = jump;
});
canvas.addEventListener("mousedown", ()=> velocity = jump);
canvas.addEventListener("touchstart", ()=> velocity = jump);

document.getElementById("overrideTitle").addEventListener("click", ()=>{
  overrideClicks++;
  clearTimeout(overrideTimeout);
  overrideTimeout = setTimeout(()=>overrideClicks=0, 1000);
  if(overrideClicks >= 3){
    const code = prompt("Enter code:");
    if(code === "696969") openAdmin();
    overrideClicks = 0;
  }
});

function openAdmin(){ document.getElementById("adminPanel").style.display = "block"; }
function closeAdmin(){ document.getElementById("adminPanel").style.display = "none"; }
function toggleInvincible(){ invincible = !invincible; }
function setScore(){ score = parseInt(document.getElementById("scoreInput").value) || score; }

document.getElementById("birdColorPicker").addEventListener("input", e=>birdColor = e.target.value);
document.getElementById("pipeColorPicker").addEventListener("input", e=>pipeColor = e.target.value);
document.getElementById("bgColorPicker").addEventListener("input", e=>bgColor = e.target.value);

document.getElementById("birdImageInput").addEventListener("change", e=>{
  const file = e.target.files[0];
  if(file){
    const img = new Image();
    img.onload = ()=> customBirdImg = img;
    img.src = URL.createObjectURL(file);
  }
});

document.getElementById("bgImageInput").addEventListener("change", e=>{
  const file = e.target.files[0];
  if(file){
    const img = new Image();
    img.onload = ()=> customBgImg = img;
    img.src = URL.createObjectURL(file);
  }
});

pipes.push({x:canvas.width/2+50, y:200});
gameLoop();
</script>
</body>
</html>